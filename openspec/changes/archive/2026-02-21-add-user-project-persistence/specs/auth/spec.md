## ADDED Requirements

### Requirement: 用户认证数据持久化
系统 SHALL 将用户注册与登录数据持久化到真实数据库（PostgreSQL）。用户注册时 SHALL 将用户写入持久化数据库；密码 SHALL 以哈希（如 bcrypt）存储，禁止明文落库；昵称 SHALL 在数据库中唯一。用户登录时 SHALL 从持久化数据库校验昵称与密码并建立会话；服务重启后同一账号仍可登录。

#### Scenario: 注册写入持久化数据库
- **WHEN** 用户提交有效注册信息
- **THEN** 系统将用户记录写入 PostgreSQL
- **AND** 密码以哈希形式存储

#### Scenario: 昵称唯一性
- **WHEN** 用户注册时昵称与已有用户重复
- **THEN** 系统返回错误（如「该昵称已被注册」）
- **AND** 不写入新记录

#### Scenario: 登录从持久化数据库校验
- **WHEN** 用户提交登录请求
- **THEN** 系统从 PostgreSQL 查询用户并校验密码
- **AND** 校验通过后建立会话

#### Scenario: 重启后仍可登录
- **WHEN** 服务重启后
- **THEN** 已注册用户使用同一昵称与密码仍可成功登录
- **AND** 用户数据未丢失

---

### Requirement: 登录失败统一提示
系统 SHALL 在登录失败时统一提示「昵称或密码错误」，不暴露是昵称不存在还是密码错误。

#### Scenario: 昵称不存在时提示
- **WHEN** 用户提交的昵称在数据库中不存在
- **THEN** 系统返回与密码错误相同的提示（如「昵称或密码错误」）
- **AND** HTTP 状态码为 401

#### Scenario: 密码错误时提示
- **WHEN** 用户提交的昵称存在但密码错误
- **THEN** 系统返回与昵称不存在相同的提示（如「昵称或密码错误」）
- **AND** HTTP 状态码为 401
