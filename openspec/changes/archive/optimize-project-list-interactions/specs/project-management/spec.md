## ADDED Requirements

### Requirement: 项目卡片局部刷新
系统在更新单个项目后，SHALL 仅刷新对应的项目卡片，不重新加载整个项目列表。

#### Scenario: 编辑项目后局部刷新
- **GIVEN** 用户在项目列表页面
- **WHEN** 用户编辑项目 A 并保存成功
- **THEN** 仅更新项目 A 的卡片显示
- **AND** 其他项目卡片保持原状态不变
- **AND** 不出现加载动画或闪烁

#### Scenario: 新增项目后追加到列表
- **GIVEN** 用户在项目列表页面
- **WHEN** 用户创建新项目并保存成功
- **THEN** 新项目卡片追加到列表末尾
- **AND** 现有项目卡片保持原状态

#### Scenario: 删除项目后移除卡片
- **GIVEN** 用户在项目列表页面
- **WHEN** 用户删除项目 B
- **THEN** 项目 B 的卡片从列表中移除
- **AND** 其他项目卡片保持原状态

---

### Requirement: 项目列表数据缓存
系统 SHALL 实现项目列表数据的客户端缓存，优化从项目详情页返回列表时的体验。

#### Scenario: 从详情页返回显示缓存数据
- **GIVEN** 用户之前已加载过项目列表
- **WHEN** 用户从项目详情页返回到列表页
- **THEN** 立即显示缓存的项目列表
- **AND** 不显示加载状态
- **AND** 后台静默获取最新数据

#### Scenario: 缓存数据更新
- **GIVEN** 列表显示缓存数据
- **WHEN** 后台静默请求返回新数据
- **THEN** 如果数据有变化，平滑更新列表
- **AND** 保持当前滚动位置

#### Scenario: 手动刷新数据
- **GIVEN** 用户查看项目列表
- **WHEN** 用户点击刷新按钮
- **THEN** 清除缓存并重新获取数据
- **AND** 显示加载状态

---

### Requirement: 未保存变更确认
当用户在编辑项目时有未保存的变更，SHALL 在关闭抽屉前显示确认弹窗。

#### Scenario: 有关闭时显示确认
- **GIVEN** 用户正在编辑项目
- **AND** 用户已修改至少一个字段
- **WHEN** 用户点击关闭按钮或点击遮罩层
- **THEN** 显示确认弹窗
- **AND** 弹窗显示"您有未保存的更改"

#### Scenario: 选择保存并关闭
- **GIVEN** 确认弹窗已显示
- **WHEN** 用户点击"保存并关闭"按钮
- **THEN** 保存所有更改
- **AND** 关闭抽屉

#### Scenario: 选择放弃更改
- **GIVEN** 确认弹窗已显示
- **WHEN** 用户点击"放弃更改"按钮
- **THEN** 不保存任何更改
- **AND** 关闭抽屉
- **AND** 恢复原始数据

#### Scenario: 取消关闭
- **GIVEN** 确认弹窗已显示
- **WHEN** 用户点击"取消"按钮
- **THEN** 关闭确认弹窗
- **AND** 保持抽屉打开
- **AND** 保留当前编辑内容

#### Scenario: 无变更时直接关闭
- **GIVEN** 用户正在编辑项目
- **AND** 用户未修改任何字段
- **WHEN** 用户点击关闭按钮
- **THEN** 直接关闭抽屉
- **AND** 不显示确认弹窗

---

## MODIFIED Requirements

### Requirement: 项目列表页面 UI
修改现有项目列表页面 UI 规格，支持局部刷新和缓存。

#### Scenario: 显示项目列表（已修改）
- **GIVEN** 用户已登录
- **WHEN** 用户访问 `/dashboard/project` 页面
- **THEN** 系统显示所有项目的卡片列表
- **AND** 如果存在缓存数据，立即显示缓存
- **AND** 后台静默获取最新数据
- **AND** 每个项目卡片显示项目名称、描述、类型、状态、优先级和进度

#### Scenario: 显示加载状态（已修改）
- **WHEN** 项目列表正在加载且没有缓存数据
- **THEN** 系统显示骨架屏
- **AND** 骨架屏布局与项目卡片一致

---

### Requirement: 项目表单对话框
修改项目表单对话框规格，支持局部刷新和未保存确认。

#### Scenario: 提交成功后局部刷新（已修改）
- **WHEN** 用户成功提交表单
- **THEN** 系统关闭对话框
- **AND** 如果是编辑操作，更新对应项目卡片
- **AND** 如果是创建操作，追加新项目卡片到列表

---

## ADDED Requirements (测试)

### Requirement: E2E 测试覆盖
系统 SHALL 为所有新功能提供基于用户行为的 E2E 测试覆盖，测试关注用户体验而非实现细节。

#### Scenario: 编辑项目后流畅的用户体验
- **GIVEN** 用户查看项目列表，屏幕上有多个项目
- **AND** 用户记住某个未编辑项目的视觉位置和内容
- **WHEN** 用户编辑一个项目并保存
- **THEN** 被编辑的项目显示更新后的信息
- **AND** 其他项目保持原有的位置和视觉状态（无闪烁、无重新加载动画）
- **AND** 用户无需等待整个页面刷新

#### Scenario: 创建项目后无缝添加到列表
- **GIVEN** 用户正在查看项目列表
- **WHEN** 用户创建新项目并保存
- **THEN** 新项目出现在列表中
- **AND** 现有项目保持原有的位置和状态
- **AND** 用户立即看到新项目，无需等待整个页面刷新

#### Scenario: 删除项目后平滑移除
- **GIVEN** 用户查看包含多个项目的列表
- **WHEN** 用户删除一个项目
- **THEN** 被删除的项目从列表中消失
- **AND** 其他项目平滑调整位置
- **AND** 无需重新加载整个页面

#### Scenario: 从项目详情返回时的即时响应
- **GIVEN** 用户之前查看过项目列表
- **AND** 用户进入了某个项目的详情页
- **WHEN** 用户点击浏览器返回按钮或导航返回列表
- **THEN** 项目列表立即显示（无明显加载等待）
- **AND** 列表内容与之前离开时一致
- **AND** 用户的滚动位置保持（如果在同一位置）

#### Scenario: 网络较慢时的优雅降级
- **GIVEN** 用户正在查看已缓存的项目列表
- **AND** 网络连接较慢或不稳定
- **WHEN** 系统尝试在后台更新数据
- **THEN** 用户可以继续浏览和操作现有列表
- **AND** 后台更新不会阻塞用户交互
- **AND** 数据更新后平滑反映，不干扰用户操作

#### Scenario: 首次加载的加载体验
- **GIVEN** 用户首次访问项目列表（无缓存）
- **WHEN** 页面开始加载数据
- **THEN** 显示加载占位符（骨架屏）
- **AND** 占位符的布局结构与实际卡片一致
- **AND** 数据加载完成后平滑过渡到实际内容

#### Scenario: 防止未保存数据的意外丢失
- **GIVEN** 用户正在编辑项目信息
- **AND** 用户修改了至少一个字段的值
- **WHEN** 用户尝试关闭编辑面板（点击关闭按钮、遮罩层或按 ESC）
- **THEN** 系统显示确认对话框询问是否保存更改
- **AND** 对话框提供"保存并关闭"、"放弃更改"和"取消"三个明确选项

#### Scenario: 保存并关闭编辑的数据持久化
- **GIVEN** 用户在编辑项目时触发了未保存确认对话框
- **WHEN** 用户点击"保存并关闭"
- **THEN** 修改的内容被保存到服务器
- **AND** 编辑面板关闭
- **AND** 项目列表显示更新后的信息

#### Scenario: 放弃更改后的数据回滚
- **GIVEN** 用户在编辑项目时触发了未保存确认对话框
- **WHEN** 用户点击"放弃更改"
- **THEN** 编辑面板关闭
- **AND** 项目列表显示原始数据（修改未应用）
- **AND** 下次打开编辑时显示原始数据

#### Scenario: 取消关闭后继续编辑
- **GIVEN** 用户在编辑项目时触发了未保存确认对话框
- **WHEN** 用户点击"取消"
- **THEN** 确认对话框关闭
- **AND** 编辑面板保持打开
- **AND** 用户可以继续编辑，之前输入的内容保留

#### Scenario: 无修改时的流畅关闭
- **GIVEN** 用户打开项目编辑面板
- **AND** 用户未修改任何字段（或已保存所有修改）
- **WHEN** 用户关闭编辑面板
- **THEN** 面板立即关闭
- **AND** 不显示任何确认对话框
- **AND** 不触发不必要的保存操作

#### Scenario: 手动刷新获取最新数据
- **GIVEN** 用户正在查看项目列表（可能显示缓存数据）
- **WHEN** 用户点击刷新按钮
- **THEN** 系统从服务器获取最新数据
- **AND** 显示加载状态
- **AND** 加载完成后更新列表显示最新信息
